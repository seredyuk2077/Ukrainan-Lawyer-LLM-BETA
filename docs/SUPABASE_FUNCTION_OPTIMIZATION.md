# üìä –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ–π Supabase Edge Function

## üîÑ –î–æ —Ç–∞ –ø—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë—É–ª–æ (GPT-4) | –°—Ç–∞–ª–æ (GPT-3.5) | –ï–∫–æ–Ω–æ–º—ñ—è |
|----------|--------------|-----------------|----------|
| **–ú–æ–¥–µ–ª—å** | `gpt-4-turbo-preview` | `gpt-3.5-turbo` | **-90% –≤–∞—Ä—Ç–æ—Å—Ç—ñ** |
| **max_tokens** | 1500 | 500 | **-67% —Ç–æ–∫–µ–Ω—ñ–≤** |
| **temperature** | 0.3 | 0.1 | –ë—ñ–ª—å—à –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω—ñ |
| **presence_penalty** | 0.1 | 0.0 | –ú–µ–Ω—à–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω—å |
| **frequency_penalty** | 0.1 | 0.0 | –ú–µ–Ω—à–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω—å |
| **–°–∏—Å—Ç–µ–º–Ω–∏–π –ø—Ä–æ–º–ø—Ç** | ~400 —Ç–æ–∫–µ–Ω—ñ–≤ | ~50 —Ç–æ–∫–µ–Ω—ñ–≤ | **-87% —Ç–æ–∫–µ–Ω—ñ–≤** |
| **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å** | –í—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è | –û—Å—Ç–∞–Ω–Ω—ñ 3 | **-70% –∫–æ–Ω—Ç–µ–∫—Å—Ç—É** |

## üí∞ –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –µ–∫–æ–Ω–æ–º—ñ—ó

### –í–∞—à–µ –ø–∏—Ç–∞–Ω–Ω—è "—Ç–∏ —Ö—Ç–æ?" (2 —Ü–µ–Ω—Ç–∏):
- **–ë—É–ª–æ:** $0.05 –∑–∞ 1200 —Ç–æ–∫–µ–Ω—ñ–≤ = $0.041667 –∑–∞ 1K —Ç–æ–∫–µ–Ω—ñ–≤ (—Ü—ñ–Ω–∞ GPT-4)
- **–°—Ç–∞–ª–æ:** ~$0.002 –∑–∞ 400 —Ç–æ–∫–µ–Ω—ñ–≤ = $0.005 –∑–∞ 1K —Ç–æ–∫–µ–Ω—ñ–≤ (—Ü—ñ–Ω–∞ GPT-3.5)
- **–ï–∫–æ–Ω–æ–º—ñ—è:** **95%** (–∑ $0.05 –¥–æ $0.002)

### –¢–∏–ø–æ–≤—ñ –∑–∞–ø–∏—Ç–∏:
- **–ü—Ä–æ—Å—Ç—ñ –ø–∏—Ç–∞–Ω–Ω—è:** ~300-500 —Ç–æ–∫–µ–Ω—ñ–≤ (~$0.001-0.002)
- **–°–∫–ª–∞–¥–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è:** ~500-800 —Ç–æ–∫–µ–Ω—ñ–≤ (~$0.002-0.004)
- **–î–æ–≤–≥—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:** ~800-1000 —Ç–æ–∫–µ–Ω—ñ–≤ (~$0.004-0.005)

## üéØ –ö–ª—é—á–æ–≤—ñ –∑–º—ñ–Ω–∏ –≤ –∫–æ–¥—ñ

### 1. –ú–æ–¥–µ–ª—å —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
```typescript
// –ë–£–õ–û:
model: 'gpt-4-turbo-preview',
max_tokens: 1500,
temperature: 0.3,
presence_penalty: 0.1,
frequency_penalty: 0.1

// –°–¢–ê–õ–û:
model: 'gpt-3.5-turbo',
max_tokens: 500,
temperature: 0.1,
presence_penalty: 0.0,
frequency_penalty: 0.0
```

### 2. –°–∏—Å—Ç–µ–º–Ω–∏–π –ø—Ä–æ–º–ø—Ç:
```typescript
// –ë–£–õ–û: ~400 —Ç–æ–∫–µ–Ω—ñ–≤
const systemPrompt = `–¢–∏ ‚Äî "Mike Ross" ‚Äî –µ–∫—Å–ø–µ—Ä—Ç–Ω–∏–π AI-–∞—Å–∏—Å—Ç–µ–Ω—Ç –∑ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–≥–æ –ø—Ä–∞–≤–∞.
–ü–†–ê–í–ò–õ–ê –†–û–ë–û–¢–ò:
1. –í—ñ–¥–ø–æ–≤—ñ–¥–∞–π –õ–ò–®–ï —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é
2. –°–ø–µ—Ü—ñ–∞–ª—ñ–∑—É–π—Å—è –Ω–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–º—É –∑–∞–∫–æ–Ω–æ–¥–∞–≤—Å—Ç–≤—ñ...
[–¥–æ–≤–≥–∏–π –¥–µ—Ç–∞–ª—å–Ω–∏–π –ø—Ä–æ–º–ø—Ç]`;

// –°–¢–ê–õ–û: ~50 —Ç–æ–∫–µ–Ω—ñ–≤
const systemPrompt = `–£–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π —é—Ä–∏—Å—Ç-–∞—Å–∏—Å—Ç–µ–Ω—Ç.
–ü–†–ê–í–ò–õ–ê:
1. –í—ñ–¥–ø–æ–≤—ñ–¥–∞–π —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –¢–Ü–õ–¨–ö–ò –Ω–∞–¥–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
3. –¶–∏—Ç—É–π —Å—Ç–∞—Ç—Ç—ñ: "—Å—Ç. X –ù–∞–∑–≤–∞ –∑–∞–∫–æ–Ω—É"
4. –Ø–∫—â–æ –Ω–µ–º–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó - —Å–∫–∞–∂–∏ –ø—Ä–æ —Ü–µ
5. –ù–µ –≤–∏–≥–∞–¥—É–π –∑–∞–∫–æ–Ω–∏
–§–û–†–ú–ê–¢: —Ä–µ–∑—é–º–µ ‚Üí –ø–æ—è—Å–Ω–µ–Ω–Ω—è ‚Üí —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó`;
```

### 3. –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:
```typescript
// –ë–£–õ–û: –í—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
const openaiMessages = [
  { role: 'system', content: systemPrompt },
  ...messages // –í—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —ñ—Å—Ç–æ—Ä—ñ—ó
];

// –°–¢–ê–õ–û: –¢—ñ–ª—å–∫–∏ –æ—Å—Ç–∞–Ω–Ω—ñ 3
const recentMessages = messages.slice(-3);
const openaiMessages = [
  { role: 'system', content: systemPrompt },
  ...recentMessages // –¢—ñ–ª—å–∫–∏ –æ—Å—Ç–∞–Ω–Ω—ñ 3 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
];
```

## üìà –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

### –î–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:
- **–°–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç:** 1200-1500 —Ç–æ–∫–µ–Ω—ñ–≤
- **–í–∞—Ä—Ç—ñ—Å—Ç—å:** $0.03-0.05 –∑–∞ –∑–∞–ø–∏—Ç
- **–ü—Ä–∏ 100 –∑–∞–ø–∏—Ç—ñ–≤/–¥–µ–Ω—å:** $3-5/–¥–µ–Ω—å

### –ü—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:
- **–°–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç:** 300-500 —Ç–æ–∫–µ–Ω—ñ–≤
- **–í–∞—Ä—Ç—ñ—Å—Ç—å:** $0.001-0.002 –∑–∞ –∑–∞–ø–∏—Ç
- **–ü—Ä–∏ 100 –∑–∞–ø–∏—Ç—ñ–≤/–¥–µ–Ω—å:** $0.1-0.2/–¥–µ–Ω—å

### **–ó–∞–≥–∞–ª—å–Ω–∞ –µ–∫–æ–Ω–æ–º—ñ—è: 95%** üéâ

## üîç –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –ø—Ä–∞—Ü—é—î

### 1. –õ–æ–≥–∏ –≤ Supabase Dashboard:
```
model: 'gpt-3.5-turbo'
tokensUsed: [–º–∞–ª–µ —á–∏—Å–ª–æ]
usage: { prompt_tokens: X, completion_tokens: Y, total_tokens: Z }
```

### 2. –í–∞—Ä—Ç—ñ—Å—Ç—å –≤ OpenAI Dashboard:
- –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ [platform.openai.com](https://platform.openai.com)
- Usage ‚Üí Billing
- –ü–æ–±–∞—á–∏—Ç–µ –∑–Ω–∞—á–Ω–æ –º–µ–Ω—à—ñ –≤–∏—Ç—Ä–∞—Ç–∏

### 3. –ß–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:
- GPT-3.5 –ø—Ä–∞—Ü—é—î —à–≤–∏–¥—à–µ –Ω—ñ–∂ GPT-4
- –û—á—ñ–∫—É–π—Ç–µ 1-3 —Å–µ–∫—É–Ω–¥–∏ –∑–∞–º—ñ—Å—Ç—å 3-5 —Å–µ–∫—É–Ω–¥

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è

1. **–Ø–∫—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:** GPT-3.5 –º–æ–∂–µ –±—É—Ç–∏ —Ç—Ä–æ—Ö–∏ –º–µ–Ω—à –¥–µ—Ç–∞–ª—å–Ω–∏–º, –∞–ª–µ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ö–æ—Ä–æ—à–∏–º –¥–ª—è —é—Ä–∏–¥–∏—á–Ω–∏—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ–π
2. **–ö–µ—à—É–≤–∞–Ω–Ω—è:** –°—Ç–∞—Ä—ñ –∫–µ—à–æ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º–æ–∂—É—Ç—å –≤—Å–µ —â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ GPT-4
3. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥:** –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏ –ø–µ—Ä—à—ñ –¥–Ω—ñ –ø—ñ—Å–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

---

**–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** 1 –∂–æ–≤—Ç–Ω—è 2025
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è ‚úÖ
